# Story 4.18: Reports & Analytics - Dark Mode & Print Support

## Status
Ready for Review

## Story
As a user,
I want dark mode and optimized printing,
So that I can work comfortably and create clean physical reports.

## Acceptance Criteria
1. Dark/light mode toggle with system preference detection
2. Theme persistence across sessions
3. Chart colors adapt to dark mode (legible lines, axes, legends)
4. Print CSS optimizes output (hide controls/nav, high-contrast, white background)
5. Export/print hides non-essential UI and respects page breaks

## Tasks / Subtasks
- [ ] Implement `ThemeContext` with `prefers-color-scheme` detection
- [ ] Persist theme selection (localStorage)
- [ ] `useChartTheme` to supply Recharts/D3 color tokens per theme
- [ ] Define CSS variables/tokens and Tailwind config mappings
- [ ] Create dedicated print stylesheet
  - [ ] `src/print.css` and include in `index.html` with `media="print"`
  - [ ] Hide nav, filters, buttons; ensure white background; page breaks for sections
- [ ] Audit dark mode contrast (WCAG AA)

## Dev Notes
- References:
  - `docs/implementation-plans/expense-reports-ui-improvement-plan.md` (Theming/Print)
  - `docs/implementation-plans/expense-reports-components-guide.md` â†’ `useChartTheme`
- Suggested locations:
  - `src/contexts/ThemeContext.tsx`
  - `src/hooks/useChartTheme.ts`
  - `src/print.css` and `index.html`
- Consider CSS variables for semantic tokens (bg, text, chart series)
- Foundation: Story 4.0 provides base architecture
- Location: New ReportsAnalytics section (not ExpenseManagement)
- No legacy code dependencies

## Testing
- [ ] System preference detection and manual toggle
- [ ] Theme persists and syncs across tabs
- [ ] Charts: axes/labels/legends readable in dark mode
- [ ] Print preview clean output; page breaks correct
- [ ] A11y: contrast ratios meet WCAG AA

## Success Metrics
- Dark mode adoption: >40% of active users
- Print success: 0 layout truncations in QA templates

## Integration Points
- All chart components via `useChartTheme`
- Export/print flows reuse print CSS for fidelity

## Prerequisites
- Story 4.0 (Reports & Analytics Foundation) must be completed

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-16 | 1.0 | Initial story creation | Team |
